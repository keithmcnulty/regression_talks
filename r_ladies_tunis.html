<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Statistical Inference and Regression Analysis using R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Keith McNulty" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Statistical Inference and Regression Analysis using R
### Keith McNulty

---




class: left, middle, r-logo

## Note on source

This document is a summary learning developed for the R Ladies Tunis Meetup on 26 February 2021.  It is based on material in the open source book *[Handbook of Regression Modeling in People Analytics](http://peopleanalytics-regression-book.org)* and other named sources. Please consult this book for a deeper understanding/treatment. 

This document is coded in R Markdown using the `xaringan` package. The code for this document is [here](https://github.com/keithmcnulty/peopleanalytics-regression-book/tree/master/presentations/r_ladies_tunis.Rmd).

---
class: left, middle, r-logo

## Inference versus Prediction

&lt;table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Approach &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Objective &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Examples &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Considerations &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;border-right:1px solid;background-color: yellow !important;"&gt; Inferential Modeling (Why?) &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; background-color: yellow !important;"&gt; Accurately describe a relationship between inputs and an outcome &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; background-color: yellow !important;"&gt; Regression models &lt;/td&gt;
   &lt;td style="text-align:left;background-color: yellow !important;"&gt; No need for train/test split.  Priority is to understand and interpret coefficient and fit parameters. &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;border-right:1px solid;"&gt; Predictive Modeling (What if?) &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Accurately predict the outcome for new observations &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Machine learning models (decision trees, neural networks, some regression models) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Train/test split required.  Priority is accurate prediction of test observations &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
class: left, middle, r-logo

## Examples of inferential methods we will look at today

* **Hypothesis testing**: a common approach to deciding if a statement is true for a population based on a sample of data (Chapter 3 of the book)
* **Linear regression**:  a way of describing a linear relationship between a set of input variables and a *continuous* outcome variable (for example, height, weight, money)  (Chapter 4 of the book)
* **Binomial logistic regression**:  a way of describing the relationship between a set of input variables and the *likelihood of a binary event occurring* (Chapter 5 of the book)

---
class: left, middle, r-logo

## We will use datasets in the `peopleanalyticsdata` package


```r
# install package if needed
# install.packages("peopleanalyticsdata")

library(peopleanalyticsdata)
data(package = "peopleanalyticsdata")
```

```
Data sets in package ‘peopleanalyticsdata’:

charity_donation                  Charity donation data
employee_performance              Employee performance data
employee_survey                   Employee survey data
graduates                         Graduate salary data
health_insurance                  Health insurance data
job_retention                     Job retention data
learning                          Learning program feedback data
managers                          Manager performance data
politics_survey                   Politics survey data
promotion                         Promotion data
recruiting                        Recruiting data
salespeople                       Salespeople promotion data
soccer                            Soccer discipline data
sociological_data                 Sociological survey data
speed_dating                      Speed dating data
ugtests                           Undergraduate examination data
```

---
class: left, middle, r-logo


## Populations and samples

In statistics and analytics, we are usually asked questions about a population, but we only have a sample of data.

**Example:**  Imagine a research study to determine if vaccination with two doses of different COVID vaccines produces a different outcome to vaccination with two doses of the same vaccine?

The question refers to *everyone* - past, present and future.  We want to make a general conclusion that can guide future vaccination strategy.

But our data will not be data for everyone - it will only be a sample.  Generally, bigger samples give us more certainty about the true answer to the question, but we can never be 100% certain of the truth.

---
class: left, middle, r-logo

# Example 1: Hypothesis testing

---
class: left, middle, r-logo

## The `salespeople` data set


```r
# view first few rows of salespeople data 
head(salespeople)
```

```
##   promoted sales customer_rate performance
## 1        0   594          3.94           2
## 2        0   446          4.06           3
## 3        1   674          3.83           4
## 4        0   525          3.62           2
## 5        1   657          4.40           3
## 6        1   918          4.54           2
```

```r
# view summary
summary(salespeople)
```

```
##     promoted          sales       customer_rate    performance 
##  Min.   :0.0000   Min.   :151.0   Min.   :1.000   Min.   :1.0  
##  1st Qu.:0.0000   1st Qu.:389.2   1st Qu.:3.000   1st Qu.:2.0  
##  Median :0.0000   Median :475.0   Median :3.620   Median :3.0  
##  Mean   :0.3219   Mean   :527.0   Mean   :3.608   Mean   :2.5  
##  3rd Qu.:1.0000   3rd Qu.:667.2   3rd Qu.:4.290   3rd Qu.:3.0  
##  Max.   :1.0000   Max.   :945.0   Max.   :5.000   Max.   :4.0  
##                   NA's   :1       NA's   :1       NA's   :1
```

---
class: left, middle, r-logo

## Do high performing salespeople generate more sales than low performing salespeople?



```r
library(dplyr)

# reduce to complete cases to remove NAs
salespeople &lt;- salespeople %&gt;% 
  dplyr::filter(complete.cases(.))
```




```r
# high performer sales
high &lt;- salespeople %&gt;% 
  dplyr::filter(performance == 4) %&gt;% 
  dplyr::pull(sales)
  
# low performer sales
low &lt;- salespeople %&gt;% 
  dplyr::filter(performance == 1) %&gt;% 
  dplyr::pull(sales)

# mean difference
(mean_diff &lt;- mean(high) - mean(low))
```

```
## [1] 154.9742
```

---
class: left, middle, r-logo

## Yes for our sample, but what about for the entire population?

Let's assume that high performers generate the same or less sales than low performers.  We call this the *null hypothesis*.

We now need to examine the likelihood that our sample would look the way it does under the null hypothesis.

If we find that this is very unlikely, we reject the null hypothesis and confirm the *alternative hypothesis*: that high performers generate higher sales.

---
class: left, middle, r-logo

## Any sampled statistic of a random variable is a random variable

The mean sales difference is an estimated statistic of a random variable.  This is itself a random variable with a `\(t\)`-distribution - an approximation of the normal distribution for sample data.   The standard deviation of this distribution is known as the *standard error* of the statistic.  In this case the standard error of the mean difference can be calculated as follows:

`$$\sqrt{\frac{s_{\mathrm{high}}^2}{n_{\mathrm{high}}} + \frac{s_{\mathrm{low}}^2}{n_{\mathrm{low}}}}$$`

where `\(s_{\mathrm{high}}\)` and `\(s_{\mathrm{low}}\)` are the standard deviations of the high and low sales samples, and `\(n_{\mathrm{high}}\)` and `\(n_{\mathrm{low}}\)` are the two sample sizes.


```r
# standard error
(se &lt;- sqrt(sd(high)^2/length(high) + sd(low)^2/length(low)))
```

```
## [1] 33.47554
```

---
class: left, middle, r-logo

## Graph of the `\(t\)`-distribution 





```r
library(ggplot2)

(g &lt;- ggplot(data.frame(x = c(-5, 5)), aes(x = x)) +
  stat_function(fun = dt, args = list(df = 100.98), color = "blue") +
  geom_vline(xintercept = -mean_diff/se, linetype = "dashed", color = "red") +
  labs(x = "Standard errors around sample mean difference", y = "Density") +
  theme_minimal())
```

&lt;img src="r_ladies_tunis_files/figure-html/unnamed-chunk-9-1.png" style="display: block; margin: auto;" /&gt;

We will use a `\(t\)`-distribution with 100.98 degrees of freedom&lt;sup&gt;1&lt;/sup&gt;. Zero is our sample mean difference of 154.97 and each unit of `\(x\)` is a standard error of 33.48.  A mean difference of zero or less would equate to the area to the left of the red dashed line. *Very unlikely*.

.footnote[[1] I have calculated this manually via the &lt;a href = "https://en.wikipedia.org/wiki/Welch%E2%80%93Satterthwaite_equation"&gt;Welch–Satterthwaite equation&lt;/a&gt;, but it is automatically calculated as part of the `t.test()` function in R.  You can see my manual calculation in the source code of this document.]
---
class: left, middle, r-logo

## Confidence intervals

We calculated in our sample that the mean sales difference was 154.97.  We know from our `\(t\)`-distribution that there is a range of likelihood around this for the actual mean sales difference for the population.  
We can convert our standard errors into probability estimates.  For example, if we wanted to know how many standard errors to the left of our sample estimate corresponds to a 95% chance of containing the real population statistic:


```r
# get se multiple for 95% confidence
(conf_mult &lt;- qt(p = 0.05, df = 100.98))
```

```
## [1] -1.660084
```

```r
# now we can create a lower bound for 95% confidence interval
(lower_bound &lt;- mean_diff + conf_mult*se)
```

```
## [1] 99.40205
```

---
class: left, middle, r-logo

## We can be 95% confident that high performers generate higher sales


```r
g +
  geom_vline(xintercept = conf_mult, color = "purple")
```

&lt;img src="r_ladies_tunis_files/figure-html/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /&gt;

The red dashed line, which represents the boundary for our null hypothesis is far outside the 95% confidence interval.  We can be more than 95% confident in the alternative hypothesis, that high performers generate higher sales.

---
class: left, middle, r-logo

## Another route is to find the *p-value* of a zero population difference

We can find where the red-dashed line falls in the probability density of our `\(t\)`-distribution and ask 'what is the maximum probability of such a difference occurring?'.


```r
# get lower-tail probability
(pval &lt;- pt(-mean_diff/se, df = 100.98, lower.tail = TRUE))
```

```
## [1] 5.46606e-06
```

We look for the p-value to be less than a certain standard called `\(\alpha\)` in order to reject the null hypothesis.  Usually `\(\alpha = 0.05\)`.  Again we reject the null hypothesis in favour of the alternative hypothesis.

---
class: left, middle, r-logo

## The `t.test()` function in R does all this for you


```r
t.test(high, low, alternative = "greater")
```

```
## 
## 	Welch Two Sample t-test
## 
## data:  high and low
## t = 4.6295, df = 100.98, p-value = 5.466e-06
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  99.40204      Inf
## sample estimates:
## mean of x mean of y 
##  619.8909  464.9167
```

---
class: left, middle, r-logo

## Other common hypothesis tests: `cor.test()`

`cor.test()` tests the alternative hypothesis that there is a non-zero correlation between two variables in a sample.


```r
cor.test(salespeople$sales, salespeople$customer_rate)
```

```
## 
## 	Pearson's product-moment correlation
## 
## data:  salespeople$sales and salespeople$customer_rate
## t = 6.6952, df = 348, p-value = 8.648e-11
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.2415282 0.4274964
## sample estimates:
##      cor 
## 0.337805
```

---
class: left, middle, r-logo

## Other common hypothesis tests: `chisq.test()`

`chisq.test()` tests the alternative hypothesis that there is a difference in the distribution of a variable between categories in the data set.


```r
# contingency table of promoted versus performance
(contingency &lt;- table(salespeople$promoted, salespeople$performance))
```

```
##    
##      1  2  3  4
##   0 50 85 77 25
##   1 10 25 48 30
```

```r
# chisq test on contingency table
chisq.test(contingency)
```

```
## 
## 	Pearson's Chi-squared test
## 
## data:  contingency
## X-squared = 25.895, df = 3, p-value = 1.003e-05
```

---
class: left, middle, r-logo

# Example 2:  Linear Regression

---
class: left, middle, r-logo

## Fun exercise - the first ever model to be called a 'regression model'

In 1885, Francis Galton did a study on some British children to see how their heights related to that of their parents.  Let's grab Galton's data.


```r
# get data from URL
url &lt;- "https://raw.githubusercontent.com/keithmcnulty/peopleanalytics-regression-book/master/data/Galton.txt"
galton &lt;- read.delim(url)

# view first few rows
head(galton)
```

```
##   Family Father Mother Gender Height Kids
## 1      1   78.5   67.0      M   73.2    4
## 2      1   78.5   67.0      F   69.2    4
## 3      1   78.5   67.0      F   69.0    4
## 4      1   78.5   67.0      F   69.0    4
## 5      2   75.5   66.5      M   73.5    4
## 6      2   75.5   66.5      M   72.5    4
```

---
class: left, middle, r-logo

## What is the relationship between mid-parent height and child height

Galton simplistically expected the child's height to be perfectly explained by the average height of their parents.  We can test that using a simple linear regression model.


```r
library(dplyr)

# create midParentHeight column
galton &lt;- galton %&gt;% 
  dplyr::mutate(midParentHeight = (Father + Mother)/2)

# simple linear regression of child vs mid-parent height
simplemodel &lt;- lm(formula = Height ~ midParentHeight, data = galton)

# how much does it explain (R-squared)
summary(simplemodel)$r.squared
```

```
## [1] 0.1069774
```

---
class: left, middle, r-logo

## Galton realized that children 'regress' away from their parents height towards a mean population height



```r
ggplot(galton, aes(x = midParentHeight, y = Height)) +
  geom_point(color = "blue") +
  geom_jitter(color = "blue") +
  geom_function(fun = function(x) {y = x}) +
  geom_function(fun = function(x) {y = mean(galton$Height)}, linetype = "dotdash") +
  geom_smooth(method='lm', formula = y~x, se = FALSE, color = "red", linetype = "dashed") +
  xlab("Mid-Parent Height (inches)") +
  ylab("Child Height (inches)") +
  theme_minimal()
```

&lt;img src="r_ladies_tunis_files/figure-html/unnamed-chunk-18-1.png" style="display: block; margin: auto;" /&gt;

---
class: left, middle, r-logo

## Today, we would do a multiple regression



```r
multimodel &lt;- lm(formula = Height ~ Father + Mother + Gender, 
                 data = galton)
summary(multimodel)
```

```
## 
## Call:
## lm(formula = Height ~ Father + Mother + Gender, data = galton)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -9.523 -1.440  0.117  1.473  9.114 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 15.34476    2.74696   5.586 3.08e-08 ***
## Father       0.40598    0.02921  13.900  &lt; 2e-16 ***
## Mother       0.32150    0.03128  10.277  &lt; 2e-16 ***
## GenderM      5.22595    0.14401  36.289  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.154 on 894 degrees of freedom
## Multiple R-squared:  0.6397,	Adjusted R-squared:  0.6385 
## F-statistic:   529 on 3 and 894 DF,  p-value: &lt; 2.2e-16
```

---
class: left, middle, r-logo

## This model explains a lot about the *why* of a child's height


* We can see which variables are significant explainers of a child's height - all of them are!
* We can see the relative influence of each variable on a child's height - each *coefficient* tells us how many inches of height you gain for every extra unit of input, assuming all other inputs are the same.  For example:  a male child will gain over 5 inches over a female child of the same parents. For two children of the same gender and mother height, the height difference will be about 40% of the height difference of their fathers. 
* We can see how much of the overall variation in child height is explained by these three variables:  `\(R^2 = 0.64\)`.

---
class: left, middle, r-logo

## We now have many different regression methods available

&lt;table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Outcome &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Example &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Approach &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;border-right:1px solid;"&gt; Continuous &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Compensation in $ &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Linear Regression &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;border-right:1px solid;background-color: yellow !important;"&gt; Binary &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; background-color: yellow !important;"&gt; Promoted or Not &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; background-color: yellow !important;"&gt; Binomial Logistic Regression &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;border-right:1px solid;"&gt; Nominal Category &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Choice of Health Cover Product &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Multinomial Logistic Regression &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;border-right:1px solid;"&gt; Ordered Category &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Performance Rating &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Proportional Odds Regression &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;border-right:1px solid;"&gt; Explicit grouping in data &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Individuals in sales teams &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Mixed/Multilevel Models &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;border-right:1px solid;"&gt; Latent grouping in data &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Large survey instruments &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Sturctural Equation Models &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;border-right:1px solid;"&gt; Time-associated events &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Attrition &lt;/td&gt;
   &lt;td style="text-align:left;width: 30em; "&gt; Survival Analysis/Cox Proportional Hazard Regression &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
class: left, middle, r-logo

# Example 3: Binomial Logistic Regression

---
class: left, middle, r-logo

## The logistic function is a pretty good approximation of the normal probability distribution

$$
P(y = 1) = \frac{1}{1 + e^{-kx}}
$$


```r
ggplot() +
  xlim(-5, 5) +
  xlab("x") +
  ylab("P (cumulative)") +
  geom_function(fun = pnorm, color = "red") +
  geom_function(fun = plogis, color = "blue", linetype = "dashed")
```

&lt;img src="r_ladies_tunis_files/figure-html/unnamed-chunk-21-1.png" style="display: block; margin: auto;" /&gt;

---
class: left, middle, r-logo

## The logistic function helps us interpret how input variables affect the odds of an event

$$
\mathrm{ln}\left(\frac{P(y = 1)}{P(y = 0)}\right) = \beta_0 + \beta_1x
$$
The *log odds* of the event are linear in our input variables.  If we exponentiate this, we get:

$$
`\begin{aligned}
\frac{P(y = 1)}{P(y = 0)} &amp;= e^{\beta_0 + \beta_1x} \\
&amp;=e^{\beta_0}(e^{\beta_1})^x
\end{aligned}`
$$

If `\(x = 0\)`, the base odds of the event are `\(e^{\beta_0}\)`.  For every unit increase in `\(x\)`, the odds are multiplied by `\(e^{\beta_1}\)` - this is called an *odds ratio*.

---
class: left, middle, r-logo

## Let's go back to our `salespeople` data set

We want to answer the question: *how do the variables of sales, customer rating and performance rating influence the likelihood of a salesperson getting promoted*?


```r
head(salespeople)
```

```
##   promoted sales customer_rate performance
## 1        0   594          3.94           2
## 2        0   446          4.06           3
## 3        1   674          3.83           4
## 4        0   525          3.62           2
## 5        1   657          4.40           3
## 6        1   918          4.54           2
```

What structure does our data have?

```r
str(salespeople)
```

```
## 'data.frame':	350 obs. of  4 variables:
##  $ promoted     : int  0 0 1 0 1 1 0 0 0 0 ...
##  $ sales        : int  594 446 674 525 657 918 318 364 342 387 ...
##  $ customer_rate: num  3.94 4.06 3.83 3.62 4.4 4.54 3.09 4.89 3.74 3 ...
##  $ performance  : int  2 3 4 2 3 2 3 1 3 3 ...
```

---
class: left, middle, r-logo

## Transform the data

Our `promoted` and `performance` columns are currently integers, but they should be categorical factors.  Let's convert them.


```r
# lets use some of the new dplyr functions
salespeople &lt;- salespeople %&gt;% 
  mutate(across(starts_with("p"), ~as.factor(.x)))

str(salespeople)
```

```
## 'data.frame':	350 obs. of  4 variables:
##  $ promoted     : Factor w/ 2 levels "0","1": 1 1 2 1 2 2 1 1 1 1 ...
##  $ sales        : int  594 446 674 525 657 918 318 364 342 387 ...
##  $ customer_rate: num  3.94 4.06 3.83 3.62 4.4 4.54 3.09 4.89 3.74 3 ...
##  $ performance  : Factor w/ 4 levels "1","2","3","4": 2 3 4 2 3 2 3 1 3 3 ...
```

---
class: left, middle, r-logo

## Visualize relationships in the data using a pairplot


```r
library(GGally)

ggpairs(salespeople)
```

&lt;img src="r_ladies_tunis_files/figure-html/unnamed-chunk-25-1.png" style="display: block; margin: auto;" /&gt;

---
class: left, middle, r-logo

## Run a binomial logistic regression model to try to answer our question


```r
model &lt;- glm(formula = promoted ~ ., data = salespeople, family = "binomial")

summary(model)
```

```
## 
## Call:
## glm(formula = promoted ~ ., family = "binomial", data = salespeople)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.11890  -0.08910  -0.01981   0.00867   2.98107  
## 
## Coefficients:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -19.858932   3.444079  -5.766 8.11e-09 ***
## sales           0.040124   0.006576   6.101 1.05e-09 ***
## customer_rate  -1.112131   0.482682  -2.304   0.0212 *  
## performance2    0.263000   1.021980   0.257   0.7969    
## performance3    0.684955   0.982167   0.697   0.4856    
## performance4    0.734493   1.071964   0.685   0.4932    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 440.303  on 349  degrees of freedom
## Residual deviance:  64.374  on 344  degrees of freedom
## AIC: 76.374
## 
## Number of Fisher Scoring iterations: 8
```

---
class: left, middle, r-logo

## Exponentiate the coefficients to get odds ratios


```r
exp(model$coefficients) %&gt;% 
  round(2)
```

```
##   (Intercept)         sales customer_rate  performance2  performance3 
##          0.00          1.04          0.33          1.30          1.98 
##  performance4 
##          2.08
```

Interpretation:

1. For two salespeople with the same customer rating and the same performance, each additional thousand dollars in sales increases the odds of promotion by 4%.
2.  For two salespeople with the same sales and performance, each additional point in customer rating *decreases* the odds of promotion by 67%
3.  For two salespeople of the same sales and customer rating, performance rating has no significant effect on the odds of promotion.

---
class: left, middle, r-logo

## How much of the likelihood of promotion does my model explain?


```r
library(DescTools)

PseudoR2(model, which = c("CoxSnell", "Nagelkerke", "Tjur"))
```

```
##   CoxSnell Nagelkerke       Tjur 
##  0.6583888  0.9198193  0.8795290
```

Interpretation: our model explains more than two thirds of the variation in the promotion outcome.

---
class: left, middle, r-logo

## Visualize the model using `plotly`


```r
library(plotly)

plot_ly(data = salespeople[complete.cases(salespeople), ]) %&gt;%
  add_trace(x = ~sales, y = ~customer_rate, z = ~promoted, 
            mode = "markers", type = "scatter3d",
            marker = list(size = 5, color = "blue", symbol = 104), 
            name = "Observations") %&gt;% 
  add_trace(z = model$fitted.values, x = ~sales, y = ~customer_rate, 
            type = "mesh3d", name = "Fitted values") %&gt;%
  layout(scene = list(xaxis = list(title = 'sales'), 
                      yaxis = list(title = 'customer_rate', nticks = 5),
                      camera = list(eye = list(x = -0.5, y = 2, z = 0)),
                      zaxis = list(title = 'promoted'), aspectmode='cube')) 
```

---
class: left, middle, r-logo

## Output of previous command

<div id="htmlwidget-e497b5c122a1af161a84" style="width:504px;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-e497b5c122a1af161a84">{"x":{"visdat":{"534f1ad07d5a":["function () ","plotlyVisDat"]},"cur_data":"534f1ad07d5a","attrs":{"534f1ad07d5a":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"mode":"markers","type":"scatter3d","marker":{"size":5,"color":"blue","symbol":104},"name":"Observations","inherit":true},"534f1ad07d5a.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"z":[0.464080205078678,0.00303708192997589,0.974909147304944,0.0719831292960376,0.908401788019432,0.999994914184457,5.26941906769979e-05,2.27248644612041e-05,6.69929570559089e-05,0.000927316575610595,0.324980060743404,0.997625635814877,0.240432867626047,0.00912104663445108,0.000106014566541283,0.000193177920078336,4.66189815037459e-06,0.000199257688567573,0.00130912869119211,0.999996042247812,0.994041494406082,0.00409821404456211,0.0430789145327974,3.94628168637894e-05,0.999755693211029,0.997588783598376,0.000103096247289504,1.54553112122031e-06,1.87407567837102e-05,0.997154029984072,0.0135629278751287,0.0112308680835717,4.63575027150613e-06,0.999964154271403,0.000568433760149383,0.999157425054204,0.998347386497445,0.00107749064138317,0.999999003831575,0.173981576508584,0.000723544232220912,9.0798672944912e-06,0.999999168213166,0.0697287644420435,0.000105806188851134,0.00107941311296671,0.0201324339095056,0.00105519309645859,0.01175596702865,0.970840930670252,0.361188047169017,0.00235791649546869,0.00942349108788968,0.00255491250989098,5.4684146527335e-05,0.00130060601612002,0.999878960466148,0.000113502466718717,0.999013473766614,0.00075823153978131,0.999503519986922,0.00166525276044012,0.996043624856562,0.962257892994984,0.00135590213892807,0.0372617818931663,0.0462977399908404,0.0100759940920904,0.0646336138981771,5.2698096964862e-06,4.54229739284622e-05,0.000162397562061249,0.166473242698573,0.00104262320462282,0.0570897425782224,0.71291566911174,0.999757444970246,0.00271473544995832,0.000495288891843944,0.0430786673040042,0.999781923794393,0.129343056901504,0.00754561519076838,0.987943560940726,0.87124313847143,0.0011279342217517,0.00516957360027289,0.999298386449255,3.48143392736924e-06,0.000943013329336016,0.999565703673611,0.520538391579764,0.999998909661724,0.129906592957849,0.000147894426796461,0.00235937583631079,0.027665922965818,0.00099167025630225,0.851537493434109,0.000919907421998311,0.000255580726326794,0.000745118231441946,0.000352593513399598,0.00580056987357168,0.0298448557489269,0.921418088375096,0.000540747969852264,0.00401542094608694,7.00856843787431e-05,0.000303948607836657,0.997843791556921,0.807801806431779,0.000502792933501481,0.00927793049520079,0.00068143953624277,0.000564483489618019,0.000507765475559541,0.0130342197052536,0.99999701139275,0.997790636009639,0.290322971834489,0.997226848112651,0.273063831069739,0.00151115815317933,0.0128857999100675,0.00123572238429754,0.999129625542598,0.999989940425154,0.00376365678670042,0.999999438860516,8.59440490880558e-06,0.0013257860487541,0.000282358395385431,0.00526120148827325,5.23052315162961e-05,0.999997187789358,5.16749315450194e-07,2.09909951395695e-05,0.999585502212339,0.00374572748204688,0.000122609039714119,0.947774119294318,0.00797329987656974,0.999999147604585,0.00095003383266115,0.000210274817485474,0.000252205391145191,0.0155057715904113,0.00380151346919139,0.00180101072098823,0.0117536866319431,5.63710515618471e-06,0.99978039847537,2.15612755097247e-05,0.0276771320778998,0.999770609930881,0.999867952893368,0.997878719717484,0.000119940108532505,2.59703698029802e-06,0.999980106044098,0.000930985278670883,0.00035560286903248,0.00652068043299828,0.999999419166787,0.00817409589248044,0.0119813144383142,0.000288325370886729,0.999999439097605,0.998638225909645,0.00334047266032272,0.162666363827989,0.997437332797366,0.986310870545358,6.02954817031885e-05,0.944850016968278,0.0320068969110939,0.933848327206272,0.227884508846061,0.015545986371867,0.000285885893536175,0.363497874736089,0.894058849269772,0.999477899951097,0.00102955072499494,0.000686207706359171,0.914236370301653,0.954208879127409,0.996761016967912,4.49492757932548e-05,0.000548948604536782,0.00245519209799545,0.00117276039348835,0.0010001280500148,3.91910713961429e-06,2.63744067907219e-05,0.96568579622015,0.560379464232503,0.999780779158702,0.999952747013735,0.000692958902370705,0.954804922942141,0.957144315293153,0.00705875623492789,0.00556167419238644,0.39474414471322,0.000110355989345596,0.000247363253298169,0.999972706689078,0.000413499551299212,0.00234810776443369,0.999996542004272,0.641727572801305,0.0262198967040102,0.0124601456173281,0.000440579855277736,0.0124387360508683,0.994171668588395,0.990576192475096,0.95224487087942,0.0168628294225156,6.84014017201872e-07,0.999997633308895,0.000811724360247365,0.000933803589390485,0.0281384884354235,5.04364858977091e-05,0.999557871366431,0.00172574453608116,0.999999796297357,0.999291754527012,0.00958987602450739,0.000328617496470341,0.0336832021323436,0.037356902613507,0.0388424021959405,0.117691706735179,0.997625135246851,0.00745289990288627,0.999999734800909,0.996083650270562,0.000191664396981901,0.00231413676406388,0.409210863493293,0.529621120223947,0.00189838803969045,0.0022653385364367,0.994399612681161,0.0015643959353065,0.000508075750084539,0.00031288917391568,4.13303912540155e-05,0.999998309869232,7.94381513951467e-06,0.999996348170885,0.999540586157542,0.999929282636846,0.000702086067058027,0.0183251865099931,5.7677211699822e-06,0.000174585830403127,1.01197220082118e-07,0.00362720859391239,0.00075887489571314,1.63785067482217e-06,0.991194755957506,0.840432912429974,9.35632719659415e-05,0.000834697398315901,2.04617342370443e-05,0.236947684405563,0.222749825491523,0.999985928299855,0.000396312400505074,0.994529400974061,4.53169124353181e-06,0.000255690117812573,0.0369268565349235,0.999883720388811,0.000341839582828605,0.99996182282376,2.50784782855825e-05,0.156576365533513,0.00368772292055241,0.000807675522154356,0.0726698246106979,0.000171983886805475,0.0340399233030209,1.16042898049174e-05,0.9960648627142,0.908294886142167,0.999944085453643,0.349145249086175,0.0228484553431624,0.00246747805601071,0.00212773417558253,0.00352695977188694,5.35513804678751e-05,0.999909267307937,4.06610228894018e-05,0.0569375137796858,0.000106827053100991,0.999985925115131,0.00010629102332805,0.0141100684085845,0.997162634976237,0.999497750821409,2.67054870023127e-06,0.483485028039829,0.00440830528913679,0.308842115448589,0.00468259144562906,0.999998626184009,0.00048811023744748,3.99063865387773e-06,0.00856861172025942,0.130203655467928,0.001248688948329,0.129932173848517,0.0567729656964804,0.996995716958912,0.0236605552227721,0.00162871866438099,0.969055819643858,0.0107967078501278,1.8193628556189e-06,0.00159705157082909,9.00996637590141e-05,0.999765552922997,0.999287884720429,0.0202794150874696,0.998191983135323,0.140169135751467,9.65158429662358e-06,0.00313838046725407,0.999732669648566,1.6446367147695e-06,0.0198337861994035,0.000179456325107598,2.14024382365956e-05,0.00697669489947588,0.999997810197423,0.439788732987324,0.999257145000621,0.81252470754632,0.0199737901866574,0.531086973642222,0.0076637200973932,0.0151962077123926,0.000444817577394322],"x":{},"y":{},"type":"mesh3d","name":"Fitted values","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"sales"},"yaxis":{"title":"customer_rate","nticks":5},"camera":{"eye":{"x":-0.5,"y":2,"z":0}},"zaxis":{"title":"promoted"},"aspectmode":"cube"},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[594,446,674,525,657,918,318,364,342,387,527,716,557,450,344,372,258,338,410,937,702,469,535,342,819,736,330,274,341,717,478,487,239,825,400,728,773,425,943,510,389,270,945,497,329,389,475,383,432,619,578,411,445,440,359,419,840,393,754,441,803,444,753,688,431,511,464,473,532,280,342,320,531,373,547,611,825,431,401,517,803,586,444,693,659,416,423,756,245,419,757,617,909,516,317,425,528,416,645,390,393,394,387,450,487,607,369,489,324,417,694,651,395,442,422,404,381,501,944,753,591,735,538,451,477,436,738,902,464,944,285,453,382,414,335,935,203,348,800,436,360,674,425,901,453,350,362,486,471,459,506,262,825,291,464,802,818,736,364,308,862,349,375,423,938,456,517,373,898,777,470,545,699,697,300,677,497,669,596,492,346,590,592,780,432,418,662,678,716,330,414,416,403,362,284,363,655,597,794,818,409,681,606,489,475,590,396,420,857,371,421,828,594,533,462,392,475,752,659,650,496,211,898,388,383,455,319,756,377,940,757,469,394,484,491,547,519,739,479,943,742,357,432,584,595,401,460,753,466,362,361,338,882,293,922,793,787,400,516,295,307,151,441,406,270,680,662,347,453,309,592,540,886,420,718,284,323,513,841,362,842,321,516,428,383,521,358,489,252,720,610,871,594,522,379,454,450,317,835,297,516,355,858,305,410,707,798,265,576,448,590,456,930,412,286,440,546,385,544,505,732,506,394,674,458,251,429,348,789,795,509,754,580,289,390,787,241,522,412,359,489,940,592,796,653,459,586,401,500,373],"y":[3.94,4.06,3.83,3.62,4.4,4.54,3.09,4.89,3.74,3,2.43,3.16,3.51,3.21,3.02,3.87,2.49,2.66,3.14,5,3.53,4.24,4.47,3.6,4.45,3.94,2.54,4.06,4.47,2.98,3.48,3.74,2.47,3.32,3.53,2.66,4.89,3.62,4.4,2.56,3.34,2.56,4.31,3.02,2.86,2.98,3.39,2.36,2.33,1.94,4.17,3.07,3,3.62,3.92,3.85,5,4.49,3.74,4.75,4.89,4.15,5,4.29,4.29,3.74,2.22,3.57,3.74,3.41,3.71,2.15,3.41,2.01,4.4,4.03,4.66,3.62,3.69,4.2,4.15,5,3.21,3.8,4.2,3.87,2.75,3.55,2.52,3.76,3.11,4.33,3.21,2.47,1.51,3.53,4.63,3.37,4.08,3.16,3.76,3.07,3.87,3.62,3.46,2.49,2.22,4.98,3.05,4.47,1.9,5,3.46,2.29,4.54,4.06,3.37,4.77,5,4.43,4.93,4.03,3.05,4.49,3.87,4.13,3.05,5,3.9,3.92,3.53,4.68,3.51,2.03,3.71,5,2.72,5,4.24,3.51,3.23,4.47,2.43,2.7,4.98,3,2.89,3.41,4.38,5,5,2.7,4.95,2.54,2.7,3.78,4.24,3.78,4.01,4.82,4.17,1.67,3.05,2.54,3.69,2.91,5,2.93,2.26,4.86,4.84,3.94,2.66,4.06,1.94,4.63,3.14,4.56,4.98,4.24,2.2,4.17,2.2,4.15,4.15,4.01,4.56,4.49,3.44,3.05,3.83,2.79,2.75,2.03,4.2,4.72,3.39,4.08,3.83,2.7,3.44,3.97,1.83,4.47,4.56,4.43,4.86,5,3.85,2.77,3.39,1.37,3.05,4.86,2.98,3.85,3.83,4.89,1.97,3.14,4.31,2.52,3.51,2.54,2.47,2.36,3.21,3.09,2.08,2.82,3.55,3.85,3.57,2.86,3.44,5,3.34,3.99,4.06,3.21,4.17,2.72,3.8,3.78,3.74,2.86,4.45,4.89,5,2.26,2.66,4.03,2.63,3.51,4.15,4.08,2.56,3.34,5,3.87,1,2.31,3.34,3.25,4.1,3.09,4.77,3.62,4.86,3,4.79,3.41,4.68,5,4.03,3.69,1.85,4.2,5,2.38,3.99,3.25,2.89,3.28,2.98,3.23,3.09,3.41,1.69,3.76,2.75,5,4.75,4.59,1.83,4.29,3.69,2.66,3.9,2.61,3.9,3.41,3.67,1.99,1.37,2.38,4.72,3.48,3.6,3.18,4.77,4.03,4.22,4.1,3.64,2.29,3.55,2.66,3.48,2.89,3.57,4.36,2.79,3.6,3.39,3.32,3.41,3.69,3.71,4.31,4.61,4.33,4.7,3.57,2.01,3.14,3.05,4.72,5,5,4.86,5,4.38,5,5,2.82,3.41,1.6,4.17,2.54],"z":["0","0","1","0","1","1","0","0","0","0","0","1","0","0","0","0","0","0","0","1","1","0","0","0","1","1","0","0","0","1","0","0","0","1","0","1","1","0","1","0","0","0","1","0","0","0","0","0","1","1","1","0","0","0","0","0","1","0","1","0","1","0","1","1","0","0","0","0","0","0","0","0","0","0","0","1","1","0","0","0","1","0","0","1","1","0","0","1","0","0","1","1","1","0","0","0","0","0","1","0","0","0","0","0","0","1","0","0","0","0","1","1","0","0","0","0","0","0","1","1","0","1","1","0","0","0","1","1","0","1","0","0","0","0","0","1","0","0","1","0","0","1","0","1","0","0","0","0","0","0","0","0","1","0","1","1","1","1","0","0","1","0","0","0","1","0","0","0","1","1","0","0","1","1","0","1","0","1","1","0","0","1","0","1","0","0","1","1","1","0","0","0","0","0","0","0","1","0","1","1","0","1","1","0","0","0","0","0","1","0","0","1","0","0","0","0","0","1","1","1","0","0","1","0","0","0","0","1","0","1","1","0","0","0","0","0","0","1","0","1","1","0","0","0","1","0","0","1","0","0","0","0","1","0","1","1","1","0","0","0","0","0","0","0","0","1","1","0","0","0","0","0","1","0","1","0","0","0","1","0","1","0","0","0","0","1","0","0","0","1","1","1","0","0","0","0","0","0","1","0","0","0","1","0","0","1","1","0","1","0","0","0","1","0","0","0","0","0","0","0","1","0","0","1","0","0","0","0","1","1","0","1","0","0","0","1","0","0","0","0","0","1","0","1","1","0","0","0","0","0"],"mode":"markers","type":"scatter3d","marker":{"color":"blue","size":5,"symbol":104,"line":{"color":"rgba(31,119,180,1)"}},"name":"Observations","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"colorbar":{"title":"promoted","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[0.464080205078678,0.00303708192997589,0.974909147304944,0.0719831292960376,0.908401788019432,0.999994914184457,5.26941906769979e-05,2.27248644612041e-05,6.69929570559089e-05,0.000927316575610595,0.324980060743404,0.997625635814877,0.240432867626047,0.00912104663445108,0.000106014566541283,0.000193177920078336,4.66189815037459e-06,0.000199257688567573,0.00130912869119211,0.999996042247812,0.994041494406082,0.00409821404456211,0.0430789145327974,3.94628168637894e-05,0.999755693211029,0.997588783598376,0.000103096247289504,1.54553112122031e-06,1.87407567837102e-05,0.997154029984072,0.0135629278751287,0.0112308680835717,4.63575027150613e-06,0.999964154271403,0.000568433760149383,0.999157425054204,0.998347386497445,0.00107749064138317,0.999999003831575,0.173981576508584,0.000723544232220912,9.0798672944912e-06,0.999999168213166,0.0697287644420435,0.000105806188851134,0.00107941311296671,0.0201324339095056,0.00105519309645859,0.01175596702865,0.970840930670252,0.361188047169017,0.00235791649546869,0.00942349108788968,0.00255491250989098,5.4684146527335e-05,0.00130060601612002,0.999878960466148,0.000113502466718717,0.999013473766614,0.00075823153978131,0.999503519986922,0.00166525276044012,0.996043624856562,0.962257892994984,0.00135590213892807,0.0372617818931663,0.0462977399908404,0.0100759940920904,0.0646336138981771,5.2698096964862e-06,4.54229739284622e-05,0.000162397562061249,0.166473242698573,0.00104262320462282,0.0570897425782224,0.71291566911174,0.999757444970246,0.00271473544995832,0.000495288891843944,0.0430786673040042,0.999781923794393,0.129343056901504,0.00754561519076838,0.987943560940726,0.87124313847143,0.0011279342217517,0.00516957360027289,0.999298386449255,3.48143392736924e-06,0.000943013329336016,0.999565703673611,0.520538391579764,0.999998909661724,0.129906592957849,0.000147894426796461,0.00235937583631079,0.027665922965818,0.00099167025630225,0.851537493434109,0.000919907421998311,0.000255580726326794,0.000745118231441946,0.000352593513399598,0.00580056987357168,0.0298448557489269,0.921418088375096,0.000540747969852264,0.00401542094608694,7.00856843787431e-05,0.000303948607836657,0.997843791556921,0.807801806431779,0.000502792933501481,0.00927793049520079,0.00068143953624277,0.000564483489618019,0.000507765475559541,0.0130342197052536,0.99999701139275,0.997790636009639,0.290322971834489,0.997226848112651,0.273063831069739,0.00151115815317933,0.0128857999100675,0.00123572238429754,0.999129625542598,0.999989940425154,0.00376365678670042,0.999999438860516,8.59440490880558e-06,0.0013257860487541,0.000282358395385431,0.00526120148827325,5.23052315162961e-05,0.999997187789358,5.16749315450194e-07,2.09909951395695e-05,0.999585502212339,0.00374572748204688,0.000122609039714119,0.947774119294318,0.00797329987656974,0.999999147604585,0.00095003383266115,0.000210274817485474,0.000252205391145191,0.0155057715904113,0.00380151346919139,0.00180101072098823,0.0117536866319431,5.63710515618471e-06,0.99978039847537,2.15612755097247e-05,0.0276771320778998,0.999770609930881,0.999867952893368,0.997878719717484,0.000119940108532505,2.59703698029802e-06,0.999980106044098,0.000930985278670883,0.00035560286903248,0.00652068043299828,0.999999419166787,0.00817409589248044,0.0119813144383142,0.000288325370886729,0.999999439097605,0.998638225909645,0.00334047266032272,0.162666363827989,0.997437332797366,0.986310870545358,6.02954817031885e-05,0.944850016968278,0.0320068969110939,0.933848327206272,0.227884508846061,0.015545986371867,0.000285885893536175,0.363497874736089,0.894058849269772,0.999477899951097,0.00102955072499494,0.000686207706359171,0.914236370301653,0.954208879127409,0.996761016967912,4.49492757932548e-05,0.000548948604536782,0.00245519209799545,0.00117276039348835,0.0010001280500148,3.91910713961429e-06,2.63744067907219e-05,0.96568579622015,0.560379464232503,0.999780779158702,0.999952747013735,0.000692958902370705,0.954804922942141,0.957144315293153,0.00705875623492789,0.00556167419238644,0.39474414471322,0.000110355989345596,0.000247363253298169,0.999972706689078,0.000413499551299212,0.00234810776443369,0.999996542004272,0.641727572801305,0.0262198967040102,0.0124601456173281,0.000440579855277736,0.0124387360508683,0.994171668588395,0.990576192475096,0.95224487087942,0.0168628294225156,6.84014017201872e-07,0.999997633308895,0.000811724360247365,0.000933803589390485,0.0281384884354235,5.04364858977091e-05,0.999557871366431,0.00172574453608116,0.999999796297357,0.999291754527012,0.00958987602450739,0.000328617496470341,0.0336832021323436,0.037356902613507,0.0388424021959405,0.117691706735179,0.997625135246851,0.00745289990288627,0.999999734800909,0.996083650270562,0.000191664396981901,0.00231413676406388,0.409210863493293,0.529621120223947,0.00189838803969045,0.0022653385364367,0.994399612681161,0.0015643959353065,0.000508075750084539,0.00031288917391568,4.13303912540155e-05,0.999998309869232,7.94381513951467e-06,0.999996348170885,0.999540586157542,0.999929282636846,0.000702086067058027,0.0183251865099931,5.7677211699822e-06,0.000174585830403127,1.01197220082118e-07,0.00362720859391239,0.00075887489571314,1.63785067482217e-06,0.991194755957506,0.840432912429974,9.35632719659415e-05,0.000834697398315901,2.04617342370443e-05,0.236947684405563,0.222749825491523,0.999985928299855,0.000396312400505074,0.994529400974061,4.53169124353181e-06,0.000255690117812573,0.0369268565349235,0.999883720388811,0.000341839582828605,0.99996182282376,2.50784782855825e-05,0.156576365533513,0.00368772292055241,0.000807675522154356,0.0726698246106979,0.000171983886805475,0.0340399233030209,1.16042898049174e-05,0.9960648627142,0.908294886142167,0.999944085453643,0.349145249086175,0.0228484553431624,0.00246747805601071,0.00212773417558253,0.00352695977188694,5.35513804678751e-05,0.999909267307937,4.06610228894018e-05,0.0569375137796858,0.000106827053100991,0.999985925115131,0.00010629102332805,0.0141100684085845,0.997162634976237,0.999497750821409,2.67054870023127e-06,0.483485028039829,0.00440830528913679,0.308842115448589,0.00468259144562906,0.999998626184009,0.00048811023744748,3.99063865387773e-06,0.00856861172025942,0.130203655467928,0.001248688948329,0.129932173848517,0.0567729656964804,0.996995716958912,0.0236605552227721,0.00162871866438099,0.969055819643858,0.0107967078501278,1.8193628556189e-06,0.00159705157082909,9.00996637590141e-05,0.999765552922997,0.999287884720429,0.0202794150874696,0.998191983135323,0.140169135751467,9.65158429662358e-06,0.00313838046725407,0.999732669648566,1.6446367147695e-06,0.0198337861994035,0.000179456325107598,2.14024382365956e-05,0.00697669489947588,0.999997810197423,0.439788732987324,0.999257145000621,0.81252470754632,0.0199737901866574,0.531086973642222,0.0076637200973932,0.0151962077123926,0.000444817577394322],"x":[594,446,674,525,657,918,318,364,342,387,527,716,557,450,344,372,258,338,410,937,702,469,535,342,819,736,330,274,341,717,478,487,239,825,400,728,773,425,943,510,389,270,945,497,329,389,475,383,432,619,578,411,445,440,359,419,840,393,754,441,803,444,753,688,431,511,464,473,532,280,342,320,531,373,547,611,825,431,401,517,803,586,444,693,659,416,423,756,245,419,757,617,909,516,317,425,528,416,645,390,393,394,387,450,487,607,369,489,324,417,694,651,395,442,422,404,381,501,944,753,591,735,538,451,477,436,738,902,464,944,285,453,382,414,335,935,203,348,800,436,360,674,425,901,453,350,362,486,471,459,506,262,825,291,464,802,818,736,364,308,862,349,375,423,938,456,517,373,898,777,470,545,699,697,300,677,497,669,596,492,346,590,592,780,432,418,662,678,716,330,414,416,403,362,284,363,655,597,794,818,409,681,606,489,475,590,396,420,857,371,421,828,594,533,462,392,475,752,659,650,496,211,898,388,383,455,319,756,377,940,757,469,394,484,491,547,519,739,479,943,742,357,432,584,595,401,460,753,466,362,361,338,882,293,922,793,787,400,516,295,307,151,441,406,270,680,662,347,453,309,592,540,886,420,718,284,323,513,841,362,842,321,516,428,383,521,358,489,252,720,610,871,594,522,379,454,450,317,835,297,516,355,858,305,410,707,798,265,576,448,590,456,930,412,286,440,546,385,544,505,732,506,394,674,458,251,429,348,789,795,509,754,580,289,390,787,241,522,412,359,489,940,592,796,653,459,586,401,500,373],"y":[3.94,4.06,3.83,3.62,4.4,4.54,3.09,4.89,3.74,3,2.43,3.16,3.51,3.21,3.02,3.87,2.49,2.66,3.14,5,3.53,4.24,4.47,3.6,4.45,3.94,2.54,4.06,4.47,2.98,3.48,3.74,2.47,3.32,3.53,2.66,4.89,3.62,4.4,2.56,3.34,2.56,4.31,3.02,2.86,2.98,3.39,2.36,2.33,1.94,4.17,3.07,3,3.62,3.92,3.85,5,4.49,3.74,4.75,4.89,4.15,5,4.29,4.29,3.74,2.22,3.57,3.74,3.41,3.71,2.15,3.41,2.01,4.4,4.03,4.66,3.62,3.69,4.2,4.15,5,3.21,3.8,4.2,3.87,2.75,3.55,2.52,3.76,3.11,4.33,3.21,2.47,1.51,3.53,4.63,3.37,4.08,3.16,3.76,3.07,3.87,3.62,3.46,2.49,2.22,4.98,3.05,4.47,1.9,5,3.46,2.29,4.54,4.06,3.37,4.77,5,4.43,4.93,4.03,3.05,4.49,3.87,4.13,3.05,5,3.9,3.92,3.53,4.68,3.51,2.03,3.71,5,2.72,5,4.24,3.51,3.23,4.47,2.43,2.7,4.98,3,2.89,3.41,4.38,5,5,2.7,4.95,2.54,2.7,3.78,4.24,3.78,4.01,4.82,4.17,1.67,3.05,2.54,3.69,2.91,5,2.93,2.26,4.86,4.84,3.94,2.66,4.06,1.94,4.63,3.14,4.56,4.98,4.24,2.2,4.17,2.2,4.15,4.15,4.01,4.56,4.49,3.44,3.05,3.83,2.79,2.75,2.03,4.2,4.72,3.39,4.08,3.83,2.7,3.44,3.97,1.83,4.47,4.56,4.43,4.86,5,3.85,2.77,3.39,1.37,3.05,4.86,2.98,3.85,3.83,4.89,1.97,3.14,4.31,2.52,3.51,2.54,2.47,2.36,3.21,3.09,2.08,2.82,3.55,3.85,3.57,2.86,3.44,5,3.34,3.99,4.06,3.21,4.17,2.72,3.8,3.78,3.74,2.86,4.45,4.89,5,2.26,2.66,4.03,2.63,3.51,4.15,4.08,2.56,3.34,5,3.87,1,2.31,3.34,3.25,4.1,3.09,4.77,3.62,4.86,3,4.79,3.41,4.68,5,4.03,3.69,1.85,4.2,5,2.38,3.99,3.25,2.89,3.28,2.98,3.23,3.09,3.41,1.69,3.76,2.75,5,4.75,4.59,1.83,4.29,3.69,2.66,3.9,2.61,3.9,3.41,3.67,1.99,1.37,2.38,4.72,3.48,3.6,3.18,4.77,4.03,4.22,4.1,3.64,2.29,3.55,2.66,3.48,2.89,3.57,4.36,2.79,3.6,3.39,3.32,3.41,3.69,3.71,4.31,4.61,4.33,4.7,3.57,2.01,3.14,3.05,4.72,5,5,4.86,5,4.38,5,5,2.82,3.41,1.6,4.17,2.54],"type":"mesh3d","name":"Fitted values","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

---
class: left, middle, r-logo

# Thank you! Questions?

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
